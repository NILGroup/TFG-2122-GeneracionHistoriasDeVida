{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"Prueba T5","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyMEX/ksacletNMybZiGFY0x"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"1715d1ecbdba4a10b192c1685aea1042":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0e214b25dbf6451c8a0c310baaefa059","IPY_MODEL_a551803b80294d58a93875411d6efd0c","IPY_MODEL_1bea2e8051354214a6aab1b1d84c245c"],"layout":"IPY_MODEL_7884e4c1e3024d70ae7bf0e4cde69b68"}},"0e214b25dbf6451c8a0c310baaefa059":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6f8047a3877e41f98c6714a88c0c86d7","placeholder":"​","style":"IPY_MODEL_122a8d73be6e4a068ca94c8513588c84","value":"Downloading: 100%"}},"a551803b80294d58a93875411d6efd0c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6a6aeab0237846c6865bf5144b8bf6b0","max":791656,"min":0,"orientation":"horizontal","style":"IPY_MODEL_c54f458a5598451c886828e570d280a0","value":791656}},"1bea2e8051354214a6aab1b1d84c245c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2bea087f666c48db8b05d9b123568369","placeholder":"​","style":"IPY_MODEL_cb3ce9627d304f6c963ac1c9f60eb8b8","value":" 773k/773k [00:00&lt;00:00, 10.1kB/s]"}},"7884e4c1e3024d70ae7bf0e4cde69b68":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6f8047a3877e41f98c6714a88c0c86d7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"122a8d73be6e4a068ca94c8513588c84":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6a6aeab0237846c6865bf5144b8bf6b0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c54f458a5598451c886828e570d280a0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2bea087f666c48db8b05d9b123568369":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cb3ce9627d304f6c963ac1c9f60eb8b8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ec66be7b0f294c7f922969361ad77bd8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_792e9729ca69478fb7282f1ef656c94f","IPY_MODEL_ed434d3d04624c56ad48232f56110666","IPY_MODEL_e6da9049c7e44cb4bf3925771a4f0b45"],"layout":"IPY_MODEL_97995410e6794d7d9e10313ef46dd88c"}},"792e9729ca69478fb7282f1ef656c94f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2af9134393ed4f439cccbe05bece6d46","placeholder":"​","style":"IPY_MODEL_d00f223ec7fb4f0d8175dfb6e176f4bb","value":"Downloading: 100%"}},"ed434d3d04624c56ad48232f56110666":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2f880aad1bfe4f31bc2da853df288fa1","max":1199,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cbb67a08bcb84ddd8054f7a7302e2c5e","value":1199}},"e6da9049c7e44cb4bf3925771a4f0b45":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bd3ca16806334f85b5ac030aee66567e","placeholder":"​","style":"IPY_MODEL_4f26e99e48714de589cb50c66853cc31","value":" 1.17k/1.17k [00:00&lt;00:00, 20.4kB/s]"}},"97995410e6794d7d9e10313ef46dd88c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2af9134393ed4f439cccbe05bece6d46":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d00f223ec7fb4f0d8175dfb6e176f4bb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2f880aad1bfe4f31bc2da853df288fa1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cbb67a08bcb84ddd8054f7a7302e2c5e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bd3ca16806334f85b5ac030aee66567e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4f26e99e48714de589cb50c66853cc31":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"QMe2ORSqw7sF"},"source":["# Prueba de T5\n"]},{"cell_type":"markdown","source":["## Descarga e instalación de recursos"],"metadata":{"id":"9Uap5TTuihm2"}},{"cell_type":"markdown","source":["Para realizar las pruebas sobre T5 vamos a necesitar una serie de recursos que nos permitan acceder a su funcionalidad.\n","\n","La biblioteca que utilizaremos para acceder a ellos será la biblioteca Transformers de HuggingFace. Este módulo contiene una serie de funcionalidades que permiten realizar funciones de procesamiento de lenguaje, en nuestro caso concreto, generación de lenguaje natural."],"metadata":{"id":"sT550dktik5J"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_5yb3LjwHQru","executionInfo":{"status":"ok","timestamp":1653727294762,"user_tz":-120,"elapsed":15268,"user":{"displayName":"MARÍA CRISTINA ALAMEDA SALAS","userId":"00427886758994799022"}},"outputId":"571ad847-dfe7-4f1c-c633-80980396a7b1"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.19.2-py3-none-any.whl (4.2 MB)\n","\u001b[K     |████████████████████████████████| 4.2 MB 15.8 MB/s \n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.11.3)\n","Collecting huggingface-hub<1.0,>=0.1.0\n","  Downloading huggingface_hub-0.7.0-py3-none-any.whl (86 kB)\n","\u001b[K     |████████████████████████████████| 86 kB 1.9 MB/s \n","\u001b[?25hCollecting tokenizers!=0.11.3,<0.13,>=0.11.1\n","  Downloading tokenizers-0.12.1-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (6.6 MB)\n","\u001b[K     |████████████████████████████████| 6.6 MB 44.0 MB/s \n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.64.0)\n","Collecting pyyaml>=5.1\n","  Downloading PyYAML-6.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (596 kB)\n","\u001b[K     |████████████████████████████████| 596 kB 65.3 MB/s \n","\u001b[?25hRequirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.7.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.1.0->transformers) (4.2.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.9)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.8.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2022.5.18.1)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Installing collected packages: pyyaml, tokenizers, huggingface-hub, transformers\n","  Attempting uninstall: pyyaml\n","    Found existing installation: PyYAML 3.13\n","    Uninstalling PyYAML-3.13:\n","      Successfully uninstalled PyYAML-3.13\n","Successfully installed huggingface-hub-0.7.0 pyyaml-6.0 tokenizers-0.12.1 transformers-4.19.2\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting sentencepiece\n","  Downloading sentencepiece-0.1.96-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.2 MB)\n","\u001b[K     |████████████████████████████████| 1.2 MB 24.6 MB/s \n","\u001b[?25hInstalling collected packages: sentencepiece\n","Successfully installed sentencepiece-0.1.96\n"]}],"source":["!pip install transformers\n","!pip install sentencepiece"]},{"cell_type":"markdown","source":["## Bibliotecas necesarias"],"metadata":{"id":"W-vgYtPqi4Lf"}},{"cell_type":"markdown","metadata":{"id":"FPNaR3I5w7sM"},"source":["A continuación vamos a importar los módulos necesarios para probar el funcionamiento de t5.\n","\n","En nuestro caso utilizaremos, el módulo *T5ForConditionalGeneration* que implementa el modelo de lenguaje T5 y *T5Tokenizer* utilizado para el proceso de tokenización."]},{"cell_type":"code","source":["from transformers import T5ForConditionalGeneration, T5Tokenizer"],"metadata":{"id":"IiWp_f5EHXzH"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Tokenización"],"metadata":{"id":"AL6FKBG50hhB"}},{"cell_type":"markdown","source":["El primer paso que requiere el modelo para poder realizar el entrenamiento es la tokenización de los datos de entrada. Realizaremos una pequeaña prueba de funcionamiento como primer paso del estudio de funcionamiento del modelo.\n","\n","\n","En primer paso es descargar la versión adecuada de tokenización."],"metadata":{"id":"HfTsOvsY0lTZ"}},{"cell_type":"code","source":["tokenizer = T5Tokenizer.from_pretrained('t5-base')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":210,"referenced_widgets":["1715d1ecbdba4a10b192c1685aea1042","0e214b25dbf6451c8a0c310baaefa059","a551803b80294d58a93875411d6efd0c","1bea2e8051354214a6aab1b1d84c245c","7884e4c1e3024d70ae7bf0e4cde69b68","6f8047a3877e41f98c6714a88c0c86d7","122a8d73be6e4a068ca94c8513588c84","6a6aeab0237846c6865bf5144b8bf6b0","c54f458a5598451c886828e570d280a0","2bea087f666c48db8b05d9b123568369","cb3ce9627d304f6c963ac1c9f60eb8b8","ec66be7b0f294c7f922969361ad77bd8","792e9729ca69478fb7282f1ef656c94f","ed434d3d04624c56ad48232f56110666","e6da9049c7e44cb4bf3925771a4f0b45","97995410e6794d7d9e10313ef46dd88c","2af9134393ed4f439cccbe05bece6d46","d00f223ec7fb4f0d8175dfb6e176f4bb","2f880aad1bfe4f31bc2da853df288fa1","cbb67a08bcb84ddd8054f7a7302e2c5e","bd3ca16806334f85b5ac030aee66567e","4f26e99e48714de589cb50c66853cc31"]},"id":"ZNDmJd-lHnHW","executionInfo":{"status":"ok","timestamp":1653727302318,"user_tz":-120,"elapsed":671,"user":{"displayName":"MARÍA CRISTINA ALAMEDA SALAS","userId":"00427886758994799022"}},"outputId":"9ac00894-228a-4a67-ee49-90773fd58713"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/773k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1715d1ecbdba4a10b192c1685aea1042"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/1.17k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ec66be7b0f294c7f922969361ad77bd8"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/transformers/models/t5/tokenization_t5.py:169: FutureWarning: This tokenizer was incorrectly instantiated with a model max length of 512 which will be corrected in Transformers v5.\n","For now, this behavior is kept to avoid breaking backwards compatibility when padding/encoding with `truncation is True`.\n","- Be aware that you SHOULD NOT rely on t5-base automatically truncating your input to 512 when padding/encoding.\n","- If you want to encode/pad to sequences longer than 512 you can either instantiate this tokenizer with `model_max_length` or pass `max_length` when encoding/padding.\n","- To avoid this warning, please instantiate this tokenizer with `model_max_length` set to your preferred value.\n","  FutureWarning,\n"]}]},{"cell_type":"markdown","source":["A continuación tokenizamos una peuqeña secuencia de palabras y observamos los datos obtenidos.\n","\n","Si codificamos de nuevo el resultado debemos obtener la frase original, como es el caso."],"metadata":{"id":"k8SKWjUO02Zp"}},{"cell_type":"code","source":["sequence = \"Hello, my name \"\n","sequence_tokenized = tokenizer(sequence, return_tensors='pt')"],"metadata":{"id":"51Mya9_6Hvbm"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["sequence_tokenized"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"oQVTLHWiH3hG","executionInfo":{"status":"ok","timestamp":1653727488856,"user_tz":-120,"elapsed":5,"user":{"displayName":"MARÍA CRISTINA ALAMEDA SALAS","userId":"00427886758994799022"}},"outputId":"fd2c9df2-8c34-4fea-f9b1-47d8a5f46a9d"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'input_ids': tensor([[8774,    6,   82,  564,    1]]), 'attention_mask': tensor([[1, 1, 1, 1, 1]])}"]},"metadata":{},"execution_count":18}]},{"cell_type":"code","source":["tokenizer.decode(sequence_tokenized['input_ids'][0])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"id":"SyVlt5tA1Geo","executionInfo":{"status":"ok","timestamp":1653727489176,"user_tz":-120,"elapsed":6,"user":{"displayName":"MARÍA CRISTINA ALAMEDA SALAS","userId":"00427886758994799022"}},"outputId":"ca301098-9458-42e2-84c6-33fd5dbb56d0"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'Hello, my name</s>'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":19}]},{"cell_type":"markdown","source":["## Carga del modelo"],"metadata":{"id":"PS7kbzvK1Uau"}},{"cell_type":"markdown","source":["El primer paso es descargar la versión correcta del modelo a utilizar. Para la prueba del modelo T5 vamos a hacer uso de la versión 'T5-BASE' del modelo *T5ForConditionalGeneration*."],"metadata":{"id":"3kCVqtri1WNV"}},{"cell_type":"code","source":["model = T5ForConditionalGeneration.from_pretrained('t5-base')"],"metadata":{"id":"negGbIb70w55"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Una vez descargado probamos a generar una sequencia dada la entrada del apartado anterior."],"metadata":{"id":"7F3QRI0P1jqR"}},{"cell_type":"code","source":["sequence"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"id":"ONvTpkx_1pCR","executionInfo":{"status":"ok","timestamp":1653727493634,"user_tz":-120,"elapsed":9,"user":{"displayName":"MARÍA CRISTINA ALAMEDA SALAS","userId":"00427886758994799022"}},"outputId":"968afe66-7f8a-4787-ea1a-66ece8309a3d"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'Hello, my name '"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":21}]},{"cell_type":"code","source":["output = model.generate(sequence_tokenized['input_ids'], num_beams = 5 ,no_repeat_ngram_size = 2, max_length=100)\n","output"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JvCSHz0rHrSH","executionInfo":{"status":"ok","timestamp":1653727511863,"user_tz":-120,"elapsed":3070,"user":{"displayName":"MARÍA CRISTINA ALAMEDA SALAS","userId":"00427886758994799022"}},"outputId":"5dd1352c-7236-4773-96dd-e537b0c61454"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[    0, 32099,  8774,     6,    82,   564,    19,  2457,    11,    27,\n","           183,     3,     9,     3, 14098, 10211,     5,    27,    31,    51,\n","          2457,     5,     1]])"]},"metadata":{},"execution_count":24}]},{"cell_type":"code","source":["tokenizer.decode(output[0])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"id":"nyTQ7BxdH8y2","executionInfo":{"status":"ok","timestamp":1653727511864,"user_tz":-120,"elapsed":21,"user":{"displayName":"MARÍA CRISTINA ALAMEDA SALAS","userId":"00427886758994799022"}},"outputId":"d6a33d33-3cc4-4d71-8e78-28422f78608c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["\"<pad> <extra_id_0> Hello, my name is Michael and I am a latin american. I'm Michael.</s>\""],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":25}]}]}